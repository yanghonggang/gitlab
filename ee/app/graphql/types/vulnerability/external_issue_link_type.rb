# frozen_string_literal: true

module Types
  module Vulnerability
    class ExternalIssueLinkType < BaseObject
      graphql_name 'VulnerabilityExternalIssueLink'
      description 'Represents an external issue link of a vulnerability'

      authorize :read_vulnerability

      field :id, GraphQL::ID_TYPE, null: false,
            description: 'GraphQL ID of the external issue link'

      field :link_type, ::Types::Vulnerability::ExternalIssueLinkTypeEnum, null: false,
            description: 'Type of the external issue link'

      field :external_issue, ::Types::ExternalIssueType, null: false,
            description: 'The external issue attached to issue link',
            complexity: 10,
            resolver: Resolvers::ExternalIssueResolver
    end
  end
end
